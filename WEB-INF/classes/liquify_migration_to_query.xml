<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (C) MESH KOREA Co., Ltd. - All Rights Reserved
  ~ Unauthorized copying of this file, via any medium is strictly prohibited
  ~ Proprietary and confidential
  ~ Written by Hyungsul Kim hyungsul.kim@meshkorea.net, January 2020
  ~ 본 자료는 ㈜메쉬코리아의 영업비밀 자산으로 접근권한 있는 자 이외에는 사용할 수 없으며,
  ~ ㈜메쉬코리아의 동의 없이는 사외로 유출하거나 제3자에게 제공할 수 없습니다.
  -->

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

    <changeSet id="jongsun.park-220629-1" author="jongsun.park" context="!prod">
        <comment>drop proof_of_delivery_id in trip_stops</comment>

        <dropColumn tableName="trip_stops" columnName="proof_of_delivery_id"/>

        <rollback>
            <addColumn tableName="trip_stops">
                <column name="proof_of_delivery_id" type="BIGINT" remarks="배송완료이미지 ID"/>
            </addColumn>
        </rollback>
    </changeSet>

    <changeSet id="jongsun.park-220629-1" author="jongsun.park" context="!prod">
        <comment>add trip_stops_id in proof_of_deliveries</comment>

        <addColumn tableName="proof_of_deliveries">
            <column name="trip_stops_id" type="BIGINT" remarks="배송지 ID" afterColumn="id"/>
        </addColumn>

        <rollback>
            <dropColumn tableName="proof_of_deliveries" columnName="trip_stops_id"/>
        </rollback>
    </changeSet>

    <changeSet id="jongsun.park-220629-2" author="jongsun.park" context="!(prod or test)">
        <comment>createIndex IDX_TRIP_STOPS_ID in proof_of_deliveries</comment>

        <createIndex tableName="proof_of_deliveries" indexName="IDX_TRIP_STOPS_ID">
            <column name="trip_stops_id"/>
        </createIndex>

        <rollback>
            <dropIndex tableName="proof_of_deliveries" indexName="IDX_TRIP_STOPS_ID"/>
        </rollback>
    </changeSet>

    <changeSet id="jongsun.park-220629-3" author="jongsun.park" context="!(prod or test)">
        <comment>createIndex IDX_EXTERNAL_ID in proof_of_deliveries</comment>

        <createIndex tableName="proof_of_deliveries" indexName="IDX_EXTERNAL_ID">
            <column name="external_id"/>
        </createIndex>

        <rollback>
            <dropIndex tableName="proof_of_deliveries" indexName="IDX_EXTERNAL_ID"/>
        </rollback>
    </changeSet>

    <changeSet id="jongsun.park-220706-1" author="jongsun.park" context="!prod">
        <comment>drop external_id in proof_of_deliveries</comment>

        <dropColumn tableName="proof_of_deliveries" columnName="external_id"/>

        <rollback>
            <addColumn tableName="proof_of_deliveries">
                <column name="external_id" type="VARCHAR(45)" remarks="외부 ID"/>
            </addColumn>
        </rollback>
    </changeSet>

    <changeSet id="jongsun.park-220706-2" author="jongsun.park" context="!prod">
        <comment>add external_id in proof_of_deliveries</comment>

        <addColumn tableName="proof_of_deliveries">
            <column name="external_id" type="VARCHAR(45)" remarks="외부 ID" afterColumn="id"/>
        </addColumn>

        <rollback>
            <dropColumn tableName="proof_of_deliveries" columnName="external_id"/>
        </rollback>
    </changeSet>

    <changeSet id="jongsun.park-220706-3" author="jongsun.park" context="!(prod or test)">
        <comment>createIndex IDX_EXTERNAL_ID in proof_of_deliveries</comment>

        <createIndex tableName="proof_of_deliveries" indexName="IDX_EXTERNAL_ID">
            <column name="external_id"/>
        </createIndex>

        <rollback>
            <dropIndex tableName="proof_of_deliveries" indexName="IDX_EXTERNAL_ID"/>
        </rollback>
    </changeSet>


</databaseChangeLog>
